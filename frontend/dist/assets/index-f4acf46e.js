import{r as l,R as O,y as R,j as s,B as g,C as me,u as ke,l as ze}from"./index-2284c2c6.js";import{C as Ge,M as $e}from"./CellCpn-9200f594.js";function He({title:e,titleId:t,...a},n){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},a),e?l.createElement("title",{id:t},e):null,l.createElement("path",{fillRule:"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25Zm4.28 10.28a.75.75 0 0 0 0-1.06l-3-3a.75.75 0 1 0-1.06 1.06l1.72 1.72H8.25a.75.75 0 0 0 0 1.5h5.69l-1.72 1.72a.75.75 0 1 0 1.06 1.06l3-3Z",clipRule:"evenodd"}))}const Ue=l.forwardRef(He),Be=Ue;function Te({title:e,titleId:t,...a},n){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},a),e?l.createElement("title",{id:t},e):null,l.createElement("path",{fillRule:"evenodd",d:"M8.25 6.75a3.75 3.75 0 1 1 7.5 0 3.75 3.75 0 0 1-7.5 0ZM15.75 9.75a3 3 0 1 1 6 0 3 3 0 0 1-6 0ZM2.25 9.75a3 3 0 1 1 6 0 3 3 0 0 1-6 0ZM6.31 15.117A6.745 6.745 0 0 1 12 12a6.745 6.745 0 0 1 6.709 7.498.75.75 0 0 1-.372.568A12.696 12.696 0 0 1 12 21.75c-2.305 0-4.47-.612-6.337-1.684a.75.75 0 0 1-.372-.568 6.787 6.787 0 0 1 1.019-4.38Z",clipRule:"evenodd"}),l.createElement("path",{d:"M5.082 14.254a8.287 8.287 0 0 0-1.308 5.135 9.687 9.687 0 0 1-1.764-.44l-.115-.04a.563.563 0 0 1-.373-.487l-.01-.121a3.75 3.75 0 0 1 3.57-4.047ZM20.226 19.389a8.287 8.287 0 0 0-1.308-5.135 3.75 3.75 0 0 1 3.57 4.047l-.01.121a.563.563 0 0 1-.373.486l-.115.04c-.567.2-1.156.349-1.764.441Z"}))}const _e=l.forwardRef(Te),Fe=_e;var fe={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},he=O.createContext&&O.createContext(fe),Ve=["attr","size","title"];function Ae(e,t){if(e==null)return{};var a=Ze(e,t),n,c;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(e);for(c=0;c<u.length;c++)n=u[c],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function Ze(e,t){if(e==null)return{};var a={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;a[n]=e[n]}return a}function T(){return T=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},T.apply(this,arguments)}function ge(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),a.push.apply(a,n)}return a}function _(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?ge(Object(a),!0).forEach(function(n){We(e,n,a[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ge(Object(a)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))})}return e}function We(e,t,a){return t=Je(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Je(e){var t=Ke(e,"string");return typeof t=="symbol"?t:t+""}function Ke(e,t){if(typeof e!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var n=a.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xe(e){return e&&e.map((t,a)=>O.createElement(t.tag,_({key:a},t.attr),xe(t.child)))}function H(e){return t=>O.createElement(qe,T({attr:_({},e.attr)},t),xe(e.child))}function qe(e){var t=a=>{var{attr:n,size:c,title:u}=e,b=Ae(e,Ve),x=c||a.size||"1em",p;return a.className&&(p=a.className),e.className&&(p=(p?p+" ":"")+e.className),O.createElement("svg",T({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},a.attr,n,b,{className:p,style:_(_({color:e.color||a.color},a.style),e.style),height:x,width:x,xmlns:"http://www.w3.org/2000/svg"}),u&&O.createElement("title",null,u),e.children)};return he!==void 0?O.createElement(he.Consumer,null,a=>t(a)):t(fe)}function Xe(e){return H({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M320 448v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V120c0-13.255 10.745-24 24-24h72v296c0 30.879 25.121 56 56 56h168zm0-344V0H152c-13.255 0-24 10.745-24 24v368c0 13.255 10.745 24 24 24h272c13.255 0 24-10.745 24-24V128H344c-13.2 0-24-10.8-24-24zm120.971-31.029L375.029 7.029A24 24 0 0 0 358.059 0H352v96h96v-6.059a24 24 0 0 0-7.029-16.97z"},child:[]}]})(e)}function Ye(e){return H({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M528 448H112c-8.8 0-16 7.2-16 16v32c0 8.8 7.2 16 16 16h416c8.8 0 16-7.2 16-16v-32c0-8.8-7.2-16-16-16zm64-320c-26.5 0-48 21.5-48 48 0 7.1 1.6 13.7 4.4 19.8L476 239.2c-15.4 9.2-35.3 4-44.2-11.6L350.3 85C361 76.2 368 63 368 48c0-26.5-21.5-48-48-48s-48 21.5-48 48c0 15 7 28.2 17.7 37l-81.5 142.6c-8.9 15.6-28.9 20.8-44.2 11.6l-72.3-43.4c2.7-6 4.4-12.7 4.4-19.8 0-26.5-21.5-48-48-48S0 149.5 0 176s21.5 48 48 48c2.6 0 5.2-.4 7.7-.8L128 416h384l72.3-192.8c2.5.4 5.1.8 7.7.8 26.5 0 48-21.5 48-48s-21.5-48-48-48z"},child:[]}]})(e)}function Qe(e){return H({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M497 273L329 441c-15 15-41 4.5-41-17v-96H152c-13.3 0-24-10.7-24-24v-96c0-13.3 10.7-24 24-24h136V88c0-21.4 25.9-32 41-17l168 168c9.3 9.4 9.3 24.6 0 34zM192 436v-40c0-6.6-5.4-12-12-12H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h84c6.6 0 12-5.4 12-12V76c0-6.6-5.4-12-12-12H96c-53 0-96 43-96 96v192c0 53 43 96 96 96h84c6.6 0 12-5.4 12-12z"},child:[]}]})(e)}function et(e){return H({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 0C114.6 0 0 100.3 0 224c0 70.1 36.9 132.6 94.5 173.7 9.6 6.9 15.2 18.1 13.5 29.9l-9.4 66.2c-1.4 9.6 6 18.2 15.7 18.2H192v-56c0-4.4 3.6-8 8-8h16c4.4 0 8 3.6 8 8v56h64v-56c0-4.4 3.6-8 8-8h16c4.4 0 8 3.6 8 8v56h77.7c9.7 0 17.1-8.6 15.7-18.2l-9.4-66.2c-1.7-11.7 3.8-23 13.5-29.9C475.1 356.6 512 294.1 512 224 512 100.3 397.4 0 256 0zm-96 320c-35.3 0-64-28.7-64-64s28.7-64 64-64 64 28.7 64 64-28.7 64-64 64zm192 0c-35.3 0-64-28.7-64-64s28.7-64 64-64 64 28.7 64 64-28.7 64-64 64z"},child:[]}]})(e)}function tt(e){return H({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4z"},child:[]}]})(e)}var nt={cm:!0,mm:!0,in:!0,px:!0,pt:!0,pc:!0,em:!0,ex:!0,ch:!0,rem:!0,vw:!0,vh:!0,vmin:!0,vmax:!0,"%":!0};function at(e){if(typeof e=="number")return{value:e,unit:"px"};var t,a=(e.match(/^[0-9.]*/)||"").toString();a.includes(".")?t=parseFloat(a):t=parseInt(a,10);var n=(e.match(/[^0-9]*$/)||"").toString();return nt[n]?{value:t,unit:n}:(console.warn("React Spinners: ".concat(e," is not a valid css value. Defaulting to ").concat(t,"px.")),{value:t,unit:"px"})}function W(e){var t=at(e);return"".concat(t.value).concat(t.unit)}var st=function(e,t,a){var n="react-spinners-".concat(e,"-").concat(a);if(typeof window>"u"||!window.document)return n;var c=document.createElement("style");document.head.appendChild(c);var u=c.sheet,b=`
    @keyframes `.concat(n,` {
      `).concat(t,`
    }
  `);return u&&u.insertRule(b,0),n},F=globalThis&&globalThis.__assign||function(){return F=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++){t=arguments[a];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},F.apply(this,arguments)},rt=globalThis&&globalThis.__rest||function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,n=Object.getOwnPropertySymbols(e);c<n.length;c++)t.indexOf(n[c])<0&&Object.prototype.propertyIsEnumerable.call(e,n[c])&&(a[n[c]]=e[n[c]]);return a},lt=st("BeatLoader","50% {transform: scale(0.75);opacity: 0.2} 100% {transform: scale(1);opacity: 1}","beat");function ct(e){var t=e.loading,a=t===void 0?!0:t,n=e.color,c=n===void 0?"#000000":n,u=e.speedMultiplier,b=u===void 0?1:u,x=e.cssOverride,p=x===void 0?{}:x,y=e.size,I=y===void 0?15:y,o=e.margin,P=o===void 0?2:o,E=rt(e,["loading","color","speedMultiplier","cssOverride","size","margin"]),j=F({display:"inherit"},p),C=function(D){return{display:"inline-block",backgroundColor:c,width:W(I),height:W(I),margin:W(P),borderRadius:"100%",animation:"".concat(lt," ").concat(.7/b,"s ").concat(D%2?"0s":"".concat(.35/b,"s")," infinite linear"),animationFillMode:"both"}};return a?l.createElement("span",F({style:j},E),l.createElement("span",{style:C(1)}),l.createElement("span",{style:C(2)}),l.createElement("span",{style:C(3)})):null}const h=[];for(let e=0;e<256;++e)h.push((e+256).toString(16).slice(1));function it(e,t=0){return(h[e[t+0]]+h[e[t+1]]+h[e[t+2]]+h[e[t+3]]+"-"+h[e[t+4]]+h[e[t+5]]+"-"+h[e[t+6]]+h[e[t+7]]+"-"+h[e[t+8]]+h[e[t+9]]+"-"+h[e[t+10]]+h[e[t+11]]+h[e[t+12]]+h[e[t+13]]+h[e[t+14]]+h[e[t+15]]).toLowerCase()}let J;const ot=new Uint8Array(16);function ut(){if(!J){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");J=crypto.getRandomValues.bind(crypto)}return J(ot)}const dt=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),pe={randomUUID:dt};function mt(e,t,a){var c;if(pe.randomUUID&&!t&&!e)return pe.randomUUID();e=e||{};const n=e.random??((c=e.rng)==null?void 0:c.call(e))??ut();if(n.length<16)throw new Error("Random bytes length must be >= 16");if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,t){if(a=a||0,a<0||a+16>t.length)throw new RangeError(`UUID byte range ${a}:${a+15} is out of buffer bounds`);for(let u=0;u<16;++u)t[a+u]=n[u];return t}return it(n)}const ht=({socket:e,onInRoom:t,onLeaveRoom:a})=>{const[n,c]=l.useState(""),[u,b]=l.useState(null),[x,p]=l.useState(""),[y,I]=l.useState(2),[o,P]=l.useState(null),[E,j]=l.useState(new Map),[C,D]=l.useState([]),[K,S]=l.useState({end:!1,replay:!1}),[q,ye]=l.useState(""),[U,ve]=l.useState({}),[w,k]=l.useState(!1),[V,z]=l.useState(!1),M=l.useMemo(()=>C.find(r=>r.id===u),[C,u]),X=l.useCallback(r=>{const i=new Map;return Object.entries(r).forEach(([d,m])=>{i.set(d,{revealedCells:new Set(m.revealedCells||[]),flags:new Set(m.flags||[])})}),i},[]),be=({gameStates:r,playersStatus:i})=>{P(r),Q(i)},je=({playerId:r,isReady:i})=>{D(d=>d.map(m=>m.id===r?{...m,isReady:i}:m))},we=({playerId:r,index:i,hasFlag:d})=>{j(m=>{const f=new Map(m),N=f.get(r)||{revealedCells:new Set,flags:new Set};return d?N.flags.add(i):N.flags.delete(i),f.set(r,N),f})},Y=l.useCallback(r=>{if(r.action){const{playerId:i,action:d}=r;j(m=>{var v;const f=new Map(m),N=f.get(i)||{revealedCells:new Set,flags:new Set};return(v=d.changes)!=null&&v.revealedCells&&d.changes.revealedCells.forEach(A=>{N.revealedCells.add(A)}),f.set(i,N),f})}},[M]),Q=l.useCallback(r=>{console.log("check Ã½e");const i=r.map(d=>{const[m,f]=Object.entries(d)[0];return{id:m,name:f.playerName,status:f.status||"playing",isReady:f.isReady,isHost:f.isHost}});D(i)},[]),Ce=l.useCallback(r=>{Q(r),S(i=>({...i,end:!0})),z(!0),k(!1)},[]);l.useEffect(()=>{const r={joinedRoom:({roomId:i,playerId:d})=>{c(i),b(d),t()},setGames:be,updateState:Y,playerStatusUpdate:je,flagToggled:we,gameOver:Ce,gameStarted:()=>{k(!0),z(!1),R.success("Game Ä‘Ã£ báº¯t Ä‘áº§u!")},replayRequested:({message:i})=>{ye(i),S(d=>({...d,replay:!0}))},replayConfirmed:()=>{k(!0),z(!1),S({end:!1,replay:!1}),R.success("Game Ä‘Ã£ Ä‘Æ°á»£c báº¯t Ä‘áº§u láº¡i!")},playerLeft:({playersStatus:i,gameState:d,playerState:m})=>{R.info("Äá»‘i thá»§ Ä‘Ã£ rá»i phÃ²ng!"),D(i.map(f=>{const[N,v]=Object.entries(f)[0];return{id:N,name:v.playerName,status:"playing",isReady:v.isReady,isHost:v.isHost}})),d&&P({[i[0][0]]:d}),m&&j(X({[i[0][0]]:m})),k(!1),z(!1)},returnToLobby:()=>{Ne(),a()},error:({message:i})=>R.error(i),roomFull:({message:i})=>R.error(i),playerNotReady:({message:i})=>R.info(i),replayDeclined:({message:i})=>{R.info(i),S(d=>({...d,replay:!1}))}};return Object.entries(r).forEach(([i,d])=>{e.on(i,d)}),()=>{Object.entries(r).forEach(([i,d])=>{e.off(i,d)})}},[Y,X,t,a]);const Ne=()=>{P(null),j(new Map),D([]),c(""),b(null),k(!1),z(!1),S({end:!1,replay:!1})},ee=l.useCallback(r=>{r.trim()?e.emit("joinRoom",r,x,U,y):R.error("Vui lÃ²ng nháº­p ID phÃ²ng!")},[x,U,y,e]),te=l.useCallback(()=>{const r=mt();c(r),e.emit("joinRoom",r,x,U,y)},[x,U,y,e]),ne=l.useCallback(()=>{e.emit("startGame",n)},[n,e]),ae=l.useCallback(()=>{e.emit("toggleReadyGame",n)},[n,e]),se=l.useCallback(()=>{e.emit("replayGame",n)},[n,e]),re=l.useCallback(()=>{e.emit("leaveRoom",n)},[n,e]),le=l.useCallback(()=>{navigator.clipboard.writeText(n),R.success("ÄÃ£ sao chÃ©p ID phÃ²ng!")},[n]),ce=l.useCallback(r=>{o&&w&&e.emit("openCell",{roomId:n,index:r})},[o,w,n,e]),ie=l.useCallback((r,i)=>{i.preventDefault(),o&&w&&e.emit("toggleFlag",{roomId:n,index:r})},[o,w,n,e]),Se=l.useCallback(r=>{o&&w&&e.emit("chording",{roomId:n,index:r})},[o,w,n,e]),oe=l.useCallback((r,i,d)=>{if(!i)return null;const{ratioX:m,ratioY:f,cells:N}=i,v=E.get(d),A=(v==null?void 0:v.revealedCells)||new Set,Ee=(v==null?void 0:v.flags)||new Set;return s.jsx(g,{variant:"boxChild",className:"grid gap-[1px] bg-gray-300",style:{gridTemplateColumns:`repeat(${f}, 24px)`,gridTemplateRows:`repeat(${m}, 24px)`},children:N.map((G,L)=>{const B=A.has(L),Me=Ee.has(L),Z=!r&&w&&!B,Ie=Z&&w,De=B&&!r;let $="";return Me?$="ðŸš©":B?$=G.count>0?G.count.toString():"":V&&G.isMine?$="ðŸ’£":G.isMarkHint&&($="x"),s.jsx(Ge,{isRevealed:B,count:G.count,canInteract:Z,onClick:Ie?()=>ce(L):De?()=>Se(L):void 0,onContextMenu:Z?Le=>ie(L,Le):void 0,children:$},`${d}-${L}`)})})},[w,ce,ie,E]),Re=l.useCallback(()=>n&&o?null:s.jsxs(g,{children:[s.jsx($e,{onModeChange:ve}),s.jsx(g,{as:"input",type:"text",placeholder:"TÃªn cá»§a báº¡n",value:x,onChange:r=>p(r.target.value),className:"w-[75%]"}),s.jsx(g,{as:"input",type:"number",min:2,max:5,value:y,onChange:r=>I(Number(r.target.value)),placeholder:"Sá»‘ ngÆ°á»i",className:"w-[25%]"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(g,{as:"input",type:"text",value:n,onChange:r=>c(r.target.value),placeholder:"Nháº­p Room ID"}),s.jsx(g,{as:"button",onClick:()=>ee(n),children:"VÃ o phÃ²ng"}),s.jsx(g,{as:"button",onClick:te,children:"Táº¡o phÃ²ng"})]})]}),[n,o,x,y,ee,te]),ue=l.useCallback(()=>w?null:M!=null&&M.isHost?V?s.jsx(g,{as:"button",onClick:se,children:"ChÆ¡i láº¡i"}):Object.keys(o).length===y?s.jsx(g,{as:"button",onClick:ne,children:"Báº¯t Ä‘áº§u game"}):s.jsx(ct,{size:8,color:"#6B7280"}):s.jsx(g,{as:"button",onClick:ae,children:M!=null&&M.isReady?"Há»§y sáºµn sÃ ng":"Sáºµn sÃ ng"}),[w,M,V,o,se,ne,ae]),de=l.useCallback(r=>{const i=u===r.id;return s.jsxs(g,{className:`flex items-center ${i?"bg-gray-200":""}`,children:[s.jsx("div",{className:"flex items-center justify-center w-6 h-6 mr-2 bg-gray-400 text-white text-xs rounded-sm",children:s.jsx(tt,{})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("span",{className:"font-medium text-sm text-gray-800",children:[r.name," ",i&&"(Báº¡n)"," ",r.isHost&&"(Host)"]}),s.jsx("div",{className:`ml-1 inline-block px-1 py-0.5 text-xs rounded-sm ${r.isReady?"bg-green-200 text-green-800":"bg-gray-400 text-gray-200"}`,children:r.isReady?"Sáºµn sÃ ng":"ChÆ°a sáºµn sÃ ng"})]}),s.jsxs("div",{className:"text-xs text-gray-500 flex items-center",children:[r.status==="playing"?"Äang chÆ¡i":r.status==="won"?"Chiáº¿n tháº¯ng!":"Thua cuá»™c",r.status==="won"&&s.jsx(Ye,{className:"ml-1 text-yellow-500",size:12}),r.status==="lost"&&s.jsx(et,{className:"ml-1 text-gray-500",size:12})]})]})]},r.id)},[u]),Oe=l.useCallback(()=>!n||!o?null:s.jsxs(g,{children:[s.jsxs("div",{className:"flex justify-between items-center mb-2",children:[s.jsxs("h3",{className:"font-bold text-sm text-gray-800",children:["PhÃ²ng: ",s.jsx("span",{className:"ml-1 bg-gray-300 text-[#337ab7] px-2 py-1 text-xs rounded-sm",children:n})]}),s.jsxs("div",{className:"flex gap-2 items-center",children:[ue(),s.jsx(g,{as:"button",onClick:le,className:"text-[#337ab7]",title:"Sao chÃ©p ID phÃ²ng",children:s.jsx(Xe,{size:12})}),s.jsx(g,{as:"button",onClick:re,className:"text-[#ff0000]",title:"Rá»i khá»i phÃ²ng",children:s.jsx(Qe,{size:12})})]})]}),s.jsx("div",{className:"space-y-1",children:C.map(de)})]}),[n,o,ue,le,re,C,de]),Pe=l.useCallback(()=>!o||Object.keys(o).length===0?null:s.jsx("div",{className:"flex flex-col sm:flex-row gap-4 items-start",children:Object.entries(o).map(([r,i])=>{var d;return s.jsxs("div",{className:"flex flex-col animate-fadeIn",children:[s.jsxs("h3",{className:"text-sm font-bold text-gray-800 mb-2 flex items-center flex-wrap",children:[(d=C.find(m=>m.id===r))==null?void 0:d.name,s.jsx("span",{className:"ml-1 text-xs px-2 py-1 bg-gray-400 text-white rounded-sm",children:r===u?"Báº¡n":"Äá»‘i thá»§"})]}),s.jsx("div",{className:"overflow-x-auto",children:oe(r!==u,i,r)})]},r)})}),[o,C,u,oe]);return s.jsxs("div",{className:"p-2 sm:p-4 bg-gray-200 font-sans animate-fadeIn",children:[s.jsxs("header",{className:"w-full",children:[Re(),Oe()]}),s.jsx("main",{className:"mt-4",children:s.jsx("div",{className:"overflow-x-auto",children:Pe()})}),s.jsx(me,{open:K.end,title:"Káº¿t thÃºc",onClose:()=>S(r=>({...r,end:!1})),children:s.jsx("p",{className:"text-sm text-gray-800",children:q})}),s.jsx(me,{open:K.replay,title:"Má»i chÆ¡i láº¡i",onClose:()=>S(r=>({...r,replay:!1})),actions:[{label:"Cháº¥p nháº­n",onClick:()=>{e.emit("confirmReplay",{roomId:n}),S(r=>({...r,replay:!1}))}},{label:"Tá»« chá»‘i",onClick:()=>{e.emit("declineReplay",{roomId:n}),S(r=>({...r,replay:!1}))}}],children:s.jsx("p",{className:"text-sm text-gray-800",children:q})})]})},gt=O.memo(ht),pt=({size:e="md",className:t="",text:a})=>{const n={sm:"w-6 h-6",md:"w-12 h-12",lg:"w-16 h-16"};return s.jsxs("div",{className:`flex flex-col items-center justify-center ${t}`,children:[s.jsx("div",{className:`${n[e]} border-4 border-gray-300 border-t-gray-800 rounded-full animate-spin`,role:"status","aria-label":"Loading"}),a&&s.jsx("p",{className:"mt-3 text-sm text-gray-600 animate-pulse",children:a})]})},ft=({rooms:e,onJoinRoom:t,isLoading:a=!1})=>{const n=(c,u=8)=>c.length>u?`${c.slice(0,u)}...`:c;return s.jsx("div",{className:"w-full sm:max-w-[350px] font-sans p-2 sm:p-4 animate-fadeIn",children:s.jsxs(g,{className:"h-auto sm:h-[90vh] overflow-hidden",children:[s.jsx("h1",{className:"text-base sm:text-lg font-bold text-gray-800 mb-3",children:"ðŸ“‹ Danh sÃ¡ch phÃ²ng"}),a?s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx(pt,{text:"Äang táº£i danh sÃ¡ch phÃ²ng..."})}):e.length===0?s.jsxs("div",{className:"text-center py-8 text-gray-600",children:[s.jsx("p",{className:"text-sm",children:"ChÆ°a cÃ³ phÃ²ng nÃ o"}),s.jsx("p",{className:"text-xs mt-2",children:"HÃ£y táº¡o phÃ²ng má»›i!"})]}):s.jsx("div",{className:"flex flex-col gap-2 max-h-[calc(100vh-200px)] overflow-y-auto",children:e.map((c,u)=>s.jsxs(g,{as:"section",className:"flex items-center justify-between hover:bg-gray-100 transition-colors",style:{animationDelay:`${u*50}ms`},children:[s.jsxs("div",{className:"flex flex-col flex-1 min-w-0",children:[s.jsx("span",{className:"font-medium text-xs sm:text-sm text-gray-700 truncate",children:c.name}),s.jsxs("span",{className:"text-xs text-gray-500 truncate",children:["ID: ",n(c.id)]}),s.jsxs("span",{className:"text-xs text-gray-600 flex items-center gap-1 mt-1",children:[s.jsx(Fe,{className:"w-3 h-3 sm:w-4 sm:h-4 text-blue-600"}),c.currentPlayers,"/",c.maxPlayers]})]}),s.jsxs(g,{as:"button",onClick:()=>t(c.id),"aria-label":`Join room ${c.name}`,className:"flex items-center gap-1 text-xs sm:text-sm shrink-0 hover:scale-105 transition-transform",disabled:c.currentPlayers>=c.maxPlayers,children:[s.jsx(Be,{className:"w-4 h-4 sm:w-5 sm:h-5 text-green-600"}),s.jsx("span",{className:"hidden sm:inline",children:"Tham gia"})]})]},c.id))})]})})},xt=O.memo(ft),bt=()=>{const[e,t]=l.useState([]),[a,n]=l.useState(!1),[c,u]=l.useState(!0),[b,x]=l.useState(null),p=l.useRef(null),{selectedServer:y}=ke(o=>o.serverOptions);l.useEffect(()=>{if(!y){x("No server selected"),u(!1);return}const o=ze(`${y}/pvp`,{transports:["websocket"],upgrade:!1,forceNew:!0,reconnection:!0,reconnectionAttempts:5,reconnectionDelay:1e3,timeout:2e4});p.current=o,o.on("connect_error",E=>{x(`Connection failed: ${E.message}`),u(!1)});const P=E=>{t(E.map(j=>({id:j.id,name:j.name||`PhÃ²ng ${j.id}`,currentPlayers:j.currentPlayers,maxPlayers:j.maxPlayers}))),u(!1)};return o.on("roomList",P),o.connected?o.emit("emitRoomList"):o.on("connect",()=>{o.emit("emitRoomList")}),()=>{o.off("roomList",P),o.off("connect_error"),o.disconnect(),p.current=null}},[y]);const I=o=>{p.current&&(p.current.emit("joinRoom",o),n(!0))};return s.jsxs("div",{className:"flex flex-col sm:flex-row animate-fadeIn",children:[!a&&s.jsx(xt,{rooms:e,onJoinRoom:I,isLoading:c}),b&&s.jsxs("div",{className:"p-4 bg-red-100 border border-red-400 text-red-700 rounded m-4",children:[s.jsx("strong",{children:"Lá»—i:"})," ",b]}),p.current&&s.jsx(gt,{socket:p.current,onInRoom:()=>n(!0),onLeaveRoom:()=>n(!1)})]})};export{bt as default};
